!function(root,factory){"function"==typeof define&&define.amd?define([],factory()):"object"==typeof module&&module.exports?module.exports=factory():function install(){document&&document.body?root.zenscroll=factory():setTimeout(install,9)}()}(this,function(){"use strict";var isNativeSmoothScrollEnabledOn=function(elem){return elem&&"getComputedStyle"in window&&"smooth"===window.getComputedStyle(elem)["scroll-behavior"]};if("undefined"==typeof window||!("document"in window))return{};var makeScroller=function(container,defaultDuration,edgeOffset){var scrollTimeoutId;defaultDuration=defaultDuration||999,edgeOffset||0===edgeOffset||(edgeOffset=9);var setScrollTimeoutId=function(newValue){scrollTimeoutId=newValue},stopScroll=function(){clearTimeout(scrollTimeoutId),setScrollTimeoutId(0)},getTopWithEdgeOffset=function(elem){return Math.max(0,container.getTopOf(elem)-edgeOffset)},scrollToY=function(targetY,duration,onDone){if(stopScroll(),0===duration||duration&&duration<0||isNativeSmoothScrollEnabledOn(container.body))container.toY(targetY),onDone&&onDone();else{var startY=container.getY(),distance=Math.max(0,targetY)-startY,startTime=(new Date).getTime();duration=duration||Math.min(Math.abs(distance),defaultDuration),function loopScroll(){setScrollTimeoutId(setTimeout(function(){var p=Math.min(1,((new Date).getTime()-startTime)/duration),y=Math.max(0,Math.floor(startY+distance*(p<.5?2*p*p:p*(4-2*p)-1)));container.toY(y),p<1&&container.getHeight()+y<container.body.scrollHeight?loopScroll():(setTimeout(stopScroll,99),onDone&&onDone())},9))}()}},scrollToElem=function(elem,duration,onDone){scrollToY(getTopWithEdgeOffset(elem),duration,onDone)};return{setup:function(newDefaultDuration,newEdgeOffset){return(0===newDefaultDuration||newDefaultDuration)&&(defaultDuration=newDefaultDuration),(0===newEdgeOffset||newEdgeOffset)&&(edgeOffset=newEdgeOffset),{defaultDuration:defaultDuration,edgeOffset:edgeOffset}},to:scrollToElem,toY:scrollToY,intoView:function(elem,duration,onDone){var elemHeight=elem.getBoundingClientRect().height,elemBottom=container.getTopOf(elem)+elemHeight,containerHeight=container.getHeight(),y=container.getY(),containerBottom=y+containerHeight;getTopWithEdgeOffset(elem)<y||elemHeight+edgeOffset>containerHeight?scrollToElem(elem,duration,onDone):elemBottom+edgeOffset>containerBottom?scrollToY(elemBottom-containerHeight+edgeOffset,duration,onDone):onDone&&onDone()},center:function(elem,duration,offset,onDone){scrollToY(Math.max(0,container.getTopOf(elem)-container.getHeight()/2+(offset||elem.getBoundingClientRect().height/2)),duration,onDone)},stop:stopScroll,moving:function(){return!!scrollTimeoutId},getY:container.getY,getTopOf:container.getTopOf}},docElem=document.documentElement,getDocY=function(){return window.scrollY||docElem.scrollTop},zenscroll=makeScroller({body:document.scrollingElement||document.body,toY:function(y){window.scrollTo(0,y)},getY:getDocY,getHeight:function(){return window.innerHeight||docElem.clientHeight},getTopOf:function(elem){return elem.getBoundingClientRect().top+getDocY()-docElem.offsetTop}});if(zenscroll.createScroller=function(scrollContainer,defaultDuration,edgeOffset){return makeScroller({body:scrollContainer,toY:function(y){scrollContainer.scrollTop=y},getY:function(){return scrollContainer.scrollTop},getHeight:function(){return Math.min(scrollContainer.clientHeight,window.innerHeight||docElem.clientHeight)},getTopOf:function(elem){return elem.offsetTop}},defaultDuration,edgeOffset)},"addEventListener"in window&&!window.noZensmooth&&!isNativeSmoothScrollEnabledOn(document.body)){var isHistorySupported="history"in window&&"pushState"in history,isScrollRestorationSupported=isHistorySupported&&"scrollRestoration"in history;isScrollRestorationSupported&&(history.scrollRestoration="auto"),window.addEventListener("load",function(){isScrollRestorationSupported&&(setTimeout(function(){history.scrollRestoration="manual"},9),window.addEventListener("popstate",function(event){event.state&&"zenscrollY"in event.state&&zenscroll.toY(event.state.zenscrollY)},!1)),window.location.hash&&setTimeout(function(){var edgeOffset=zenscroll.setup().edgeOffset;if(edgeOffset){var targetElem=document.getElementById(window.location.href.split("#")[1]);if(targetElem){var targetY=Math.max(0,zenscroll.getTopOf(targetElem)-edgeOffset),diff=zenscroll.getY()-targetY;0<=diff&&diff<9&&window.scrollTo(0,targetY)}}},9)},!1);var RE_noZensmooth=new RegExp("(^|\\s)noZensmooth(\\s|$)");window.addEventListener("click",function(event){for(var anchor=event.target;anchor&&"A"!==anchor.tagName;)anchor=anchor.parentNode;if(!(!anchor||1!==event.which||event.shiftKey||event.metaKey||event.ctrlKey||event.altKey)){if(isScrollRestorationSupported){var historyState=history.state&&"object"==typeof history.state?history.state:{};historyState.zenscrollY=zenscroll.getY();try{history.replaceState(historyState,"")}catch(e){}}var href=anchor.getAttribute("href")||"";if(0===href.indexOf("#")&&!RE_noZensmooth.test(anchor.className)){var targetY=0,targetElem=document.getElementById(href.substring(1));if("#"!==href){if(!targetElem)return;targetY=zenscroll.getTopOf(targetElem)}event.preventDefault();var onDone=function(){window.location=href},edgeOffset=zenscroll.setup().edgeOffset;edgeOffset&&(targetY=Math.max(0,targetY-edgeOffset),isHistorySupported&&(onDone=function(){history.pushState({},"",href)})),zenscroll.toY(targetY,null,onDone)}}},!1)}return zenscroll});
